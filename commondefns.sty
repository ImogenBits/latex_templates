\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{commondefns}[2022/09/10 Commonly used packages and macros]
\RequirePackage{xkeyval, etoolbox, xspace}
\xspaceaddexceptions{]\}}

\newcommand{\option}[1]{
    \DeclareOptionX{#1}{
        \expandafter\providecommand\csname #1\endcsname{True}
    }
}
\newcommand{\optionimpliesnot}[2]{
    \DeclareOptionX{#1}{
        \expandafter\providecommand\csname #1\endcsname{True}
        \expandafter\def\csname #2\endcsname{}
    }
}

\option{notext}
\option{nomath}
\option{keepvarletters}
\optionimpliesnot{logic}{nomath}
\option{complexity}
\option{graphs}
\ProcessOptionsX
\let\option\undefined


% general text layout improvements
\ifdefvoid{\notext}{
    \RequirePackage[T1]{fontenc}                % better font encoding
    \RequirePackage{lmodern}                    % font with better glyphs
    \RequirePackage[ngerman, english]{babel}    % better hypenations
    \RequirePackage{parskip, microtype}         % general layout and rendering
    \RequirePackage{graphicx}                   % actually usable graphics
    \RequirePackage{pdfpages}                   % include pdfs
    \RequirePackage{adjustbox}                  % control box placement
}{}

% math symbols
\ifdefvoid{\nomath}{
    \RequirePackage{amsmath, amssymb, mathtools, stmaryrd}
    \newcommand{\mathsc}[1]{\text{\textsc{#1}}}
    \newcommand{\R}{\ensuremath{\mathbb{R}}\xspace}
    \newcommand{\N}{\ensuremath{\mathbb{N}}\xspace}
    \newcommand{\Z}{\ensuremath{\mathbb{Z}}\xspace}
    \newcommand{\Q}{\ensuremath{\mathbb{Q}}\xspace}
    \newcommand{\xor}{\ensuremath{\oplus}\xspace}
    \newcommand{\impl}{\ensuremath{\rightarrow}\xspace}
    \newcommand{\restr}[2]{\ensuremath{\left.#1\right|_{#2}}}
    \newcommand{\expans}[2]{\ensuremath{\left.#1\right|^{#2}}}
    \newtheorem{theorem}{Theorem}

    \ifdefvoid{\keepvarletters}{
        \let\ophi\phi
        \renewcommand{\phi}{\varphi}
        \renewcommand{\epsilon}{\varepsilon}
    }{}
}{}

% logic symbols
\ifdefvoid{\logic}{}{
    \newcommand{\A}{\ensuremath{\mathfrak A}\xspace}
    \newcommand{\B}{\ensuremath{\mathfrak B}\xspace}
    \newcommand{\I}{\ensuremath{\mathfrak I}\xspace}
    \newcommand{\Th}{\ensuremath{\mathsf{Th}}\xspace}
    \newcommand{\FO}{\ensuremath{\mathsf{FO}}\xspace}
    \newcommand{\Mod}{\ensuremath{\mathsf{Mod}}\xspace}
    \newcommand{\G}{\ensuremath{\mathcal G}}
    \newcommand{\K}{\ensuremath{\mathcal K}}
}

% complexity classes
\ifdefvoid{\complexity}{}{
    \newcommand{\bigO}{\ensuremath{\mathcal{O}}}

    \newcommand{\TM}{\ensuremath{\mathrm{TM}}\xspace}
    \newcommand{\DTM}{\ensuremath{\mathrm{DTM}}\xspace}
    \newcommand{\NTM}{\ensuremath{\mathrm{NTM}}\xspace}
    \newcommand{\PTM}{\ensuremath{\mathrm{PTM}}\xspace}
    \newcommand{\ATM}{\ensuremath{\mathrm{ATM}}\xspace}

    \newcommand{\co}{\ensuremath{\mathsf{co-}}}
    \newcommand{\TIME}{\ensuremath{\mathsf{TIME}}\xspace}
    \newcommand{\SPACE}{\ensuremath{\mathsf{SPACE}}\xspace}
    \newcommand{\NTIME}{\ensuremath{\mathsf{NTIME}}\xspace}
    \newcommand{\NSPACE}{\ensuremath{\mathsf{NSPACE}}\xspace}
    \newcommand{\Pcl}{\ensuremath{\mathsf{P}}\xspace}
    \newcommand{\NP}{\ensuremath{\mathsf{NP}}\xspace}
    \newcommand{\EXP}{\ensuremath{\mathsf{EXP}}\xspace}
    \newcommand{\NEXP}{\ensuremath{\mathsf{NEXP}}\xspace}
    \newcommand{\PSPACE}{\ensuremath{\mathsf{PSPACE}}\xspace}
    \newcommand{\NPSPACE}{\ensuremath{\mathsf{NPSPACE}}\xspace}
    \newcommand{\PP}{\ensuremath{\mathsf{PP}}\xspace}
    \newcommand{\Lcl}{\ensuremath{\mathsf{L}}\xspace}
}

% graphs
\ifdefvoid{\graphs}{}{
    \RequirePackage{tikz}
    \usetikzlibrary{calc, tikzmark, backgrounds, scopes, positioning, arrows.meta,
                    decorations.markings, decorations.pathmorphing, decorations.pathreplacing, decorations.shapes}
    \tikzset{every picture/.style={thick, >={Stealth[round, length=2.5mm, width=2.5mm]}}}
    \tikzset{every node/.style={circle}}
    \tikzset{dot/.style={circle, fill, inner sep=2pt}}
    \tikzset{letters/.style={fill=none, inner sep=.5pt}}
    \tikzset{outline/.style={circle, inner sep=1.5pt, minimum size=12pt, draw}}
    \tikzset{snake/.style={decorate, decoration=snake}}
}
